name: Time-Freeze Python + Node CI
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  live-dashboard:
    runs-on: ubuntu-latest
    steps:
      # 1️⃣ Checkout repo
      - uses: actions/checkout@v3

      # 2️⃣ Node.js setup
      - uses: actions/setup-node@v3
        with:
          node-version: '20'

      # 3️⃣ Python setup
      - uses: actions/setup-python@v4
        with:
          python-version: '3.12'

      # 4️⃣ Install Node deps safely
      - name: Node deps
        run: |
          if [ -f package.json ]; then
            npm install
          else
            echo "No package.json, skipping npm install"
          fi

      # 5️⃣ Mega ASCII Splash
      - name: Mega ASCII Splash
        run: |
          echo -e "\033[1;35m"
          echo "████████╗██╗ ███╗   ███╗███████╗"
          echo "╚══██╔══╝██║ ████╗ ████║██╔════╝"
          echo "   ██║   ██║ ██╔████╔██║█████╗  "
          echo "   ██║   ██║ ██║╚██╔╝██║██╔══╝  "
          echo "   ██║   ██║ ██║ ╚═╝ ██║███████╗"
          echo "   ╚═╝   ╚═╝ ╚═╝     ╚═╝╚══════╝"
          echo -e "\033[1;36m"
          echo "███████╗ ██████╗    ███████╗   ███████╗   █████████╗   ███████╗"
          echo "██╔════╝ ██╔══ ██  ╗██╔════╝   ██╔════╝        ╚██╗    ██╔════╝"
          echo "█████╗   ██████╔   ╝█████╗     █████╗         ██╔╝     █████╗  "
          echo "██╔══╝   ██╔═ ██╔   ██ ══╝     ██╔══╝       ██╔╝       ██╔══╝  "
          echo "██║      ██║   ██   ███████╗   ███████╗   ██████████╝  ███████╗"
          echo "╚═╝      ╚═╝    ╚═   ╚══════╝   ╚══════╝   ╚════════╝   ╚══════╝"
          echo -e "\033[0m"

      # 6️⃣ Python Dashboard Simulation
      - name: Python Dashboard
        run: |
          python3 - <<'EOF'
          import random, datetime

          print("\033[1;34m==== Habit Tracker Dashboard ====\033[0m")
          habits = {"Code Daily": random.randint(0,100),
                    "Exercise": random.randint(0,100),
                    "Read": random.randint(0,100),
                    "Meditate": random.randint(0,100),
                    "Sleep Well": random.randint(0,100)}
          for habit, progress in habits.items():
              bars = "#" * (progress//10)
              empty = "-" * (10 - len(bars))
              print(f"{habit:<12} [{bars}\033[0m{empty}] {progress:3d}%")

          print("\n\033[1;36mInsights:\033[0m")
          print("- Dominate your day! ❄️")
          print("- Balance is key ⚡")
          print("- Commit often, level up! 🏆")
          print("- Stay frosty! 🧊\n")

          print("\033[1;35m==== Weekly Calendar ====\033[0m")
          DAYS = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]
          TODAY = datetime.datetime.today().weekday()
          CAL = ["✓" if i<TODAY else ("→" if i==TODAY else "✗") for i in range(7)]
          print(f"[{' '.join(DAYS)}]")
          print(f"[{' '.join(CAL)}]")

          print("\033[1;32mCI/CD LIVE — Time-Freeze dashboard fully alive in logs! 🔥\033[0m")
          EOF

      # 7️⃣ Optional Node front-end build step
      - name: Node Build (optional)
        run: |
          npm run build || echo "Skipping build, no scripts defined
